/* Variabili opzionali */
:root {
  --header-h: 64px;         /* altezza header (coerente con il tuo min-height calc) */
  --sidebar-w: 80px;       /* larghezza sidebar desktop */
  --bg: #f5f8fc;
  --panel: #ffffff;
  --border: #e6edf7;
}

/* Layout base */
html, body {
  height: 100%;
}
body {
  margin: 0;
  background: var(--bg);
}

/* Header in cima: stacking dedicato per evitare che contenuti lo coprano */
app-header, .app-header {
  position: relative;
  z-index: 100; /* sotto alle modali (z-index 1200+), sopra ai contenuti */
  display: block;
  width: 100%;
  min-height: var(--header-h);
  background: var(--panel);
  border-bottom: 1px solid var(--border);
}

/* Shell: crea uno stacking context distinto dai contenuti interni */
.app-shell {
  display: flex;
  position: relative;
  z-index: 0;     /* contenuti normali */
  min-height: calc(100vh - var(--header-h));
  isolation: isolate; /* impedisce che z-index interni escano dal contesto */
  background: var(--bg);
}

/* Sidebar: fissata a sinistra nei layout desktop */
app-sidebar, .app-sidebar {
  position: relative;   /* NO fixed: così non copre il main e resta cliccabile */
  z-index: 10;          /* sopra ai contenuti di background, sotto alle modali */
  width: var(--sidebar-w);
  min-height: calc(100vh - var(--header-h));
  flex-shrink: 0;
  background: #f8fbff;
  border-right: 1px solid var(--border);
  overflow: auto;       /* scroll interno se menu è più alto della viewport */
  -webkit-overflow-scrolling: touch;
}

/* Area principale: prende lo spazio restante */
.app-main {
  position: relative;
  z-index: 0;
  flex: 1 1 auto;
  min-width: 0;     /* evita overflow contenuti grid/flex */
  padding: 24px;
  min-height: calc(100vh - var(--header-h));
  background: var(--bg);
}

/* Router outlet: non deve creare overlay */
router-outlet {
  display: block;
  position: relative;
  z-index: 0;
}

/* Modali dell’app (se usi modali globali fuori dai componenti interni) */
.app-modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.35);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 1200; /* sopra header/sidebar/main */
}
.app-modal {
  position: relative;
  z-index: 1210;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 8px 40px rgba(0,0,0,0.23);
  max-width: 90vw;
  width: 680px;
  padding: 22px;
}

/* Prevenzione overlay “fantasma”:
   se per qualunque motivo una modale viene lasciata con classe hidden, disabilita i click */
.app-modal-backdrop.is-hidden {
  pointer-events: none !important;
  opacity: 0 !important;
}

/* Migliorie click: evita che elementi decorativi catturino click fuori dai loro box */
.app-shell * {
  pointer-events: auto;
}

/* Responsivo: sidebar sopra, contenuto sotto */
@media (max-width: 800px) {
  .app-shell {
    flex-direction: column;
    min-height: calc(100vh - var(--header-h));
  }
  app-sidebar, .app-sidebar {
    width: 100%;
    height: auto;
    min-height: auto;
    border-right: none;
    border-bottom: 1px solid var(--border);
  }
  .app-main {
    min-height: auto;
    padding: 18px;
  }
}

/* Utility opzionali per contenuti interni che non devono superare lo z-index della shell */
.safe-content {
  position: relative;
  z-index: 0;
}